<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Chat CEEJA</title>

<meta name="description" content="Espaço de diálogo e colaboração entre alunos do CEEJA. Troque mensagens, compartilhe experiências e fortaleça sua jornada de estudos.">
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://accounts.google.com/gsi/client" async defer></script>

<script>
const scriptId = 'AKfycbzydwVZMhW-m19ggadu1zW-VrFiX2JqztQ2bmzFRecCY8ADjn2Sn1onqY5ZICLLj4jE2w'; // teste POST
//const scriptId = 'AKfycbzblsl__nE6S5rDuqageiRQodx2-W7JKkYjLxaOVbk-2DnMZijUILOIrlzLy7ubAhChtg'; // teste
//const scriptId = 'AKfycbyKiS4-LdfDiEueCTVICP7JYfFawqE8itmnbHUr6_LahD8DqrJVyn1ImFlB143lvYg5qA';

function handleCredentialResponse(response) {
  let styleSheet = null;
  let ruleIndex = -1;
  
  for (let i = 0; i < document.styleSheets.length; i++) {
    const sheet = document.styleSheets[i];
    try {
      const rules = sheet.cssRules || sheet.rules; // compatibilidade
      for (let j = 0; j < rules.length; j++) {
        const rule = rules[j];
        if (rule.selectorText === '.tela-cheia') {
          styleSheet = sheet;
          ruleIndex = j;
          break;
        }
      }
    }
    catch (e) {
      continue;
    }
    if (styleSheet) break;
  }
  
  if (styleSheet && ruleIndex !== -1) {
    styleSheet.deleteRule(ruleIndex);
    styleSheet.insertRule(
      `.tela-cheia {
          position: fixed;
          inset: 0;           /* top:0; right:0; bottom:0; left:0; */
          display: flex;
          align-items: center;
          justify-content: center;
          background: #fff;
      }`, 
      ruleIndex
    );
  }
  
  const existing = document.querySelector('.tela-cheia');
  if (existing) existing.remove();
  
  const div = document.createElement('div');
  div.className = 'tela-cheia';
  div.setAttribute('role', 'img');
  div.setAttribute('aria-label', 'Ampulheta animada');
  
  const img = document.createElement('img');
  img.src = 'img/ampulheta.gif'; // coloque ampulheta.gif no mesmo diretório deste arquivo
  img.alt = 'Ampulheta animada';
  
  div.appendChild(img);
  document.body.appendChild(div);
  
  window.location.href = `https://script.google.com/macros/s/${scriptId}/exec?id_token=${response.credential}`;
  //window.location.href = `https://script.google.com/macros/s/AKfycbz5V3PtUU94OFVkOP-dH5BSwBMLEmVnzqGlh3gZRN71/dev?id_token=${response.credential}`;
}
// https://console.cloud.google.com/auth/overview?project=planilhaceeja-id
</script>

<style>
body {
  margin: 0;
  height: 100vh;          /* ocupa toda a altura da tela */
  display: flex;
  flex-direction: column; /* empilha conteúdo e footer */
  
  font-family: 'Open Sans',sans-serif;
  color: #000000;
  font-size: 1em;
  line-height: 1.44em;
  background-color: #FFFFFF;
}

.tela-cheia {
  flex: 0.95; /* ocupa % do espaço disponível acima do footer */
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
}

.tela-cheia img {
  max-width: 100%;
  height: auto;
  display: block;
</style>
</head>

<body>
<div class="tela-cheia">
<h2>Acessar o chat</h2>

<p>Use sua conta Google para entrar.</p>

<div id="g_id_onload" data-client_id="453193392660-ftlj3r3c0s9vkembqckaub69fgnau7rm.apps.googleusercontent.com" data-callback="handleCredentialResponse" data-auto_select="true"></div>
<div
  id="login"
  class="g_id_signin"
  data-type="standard"
  data-shape="pill"
  data-theme="outline"
  data-text="signin_with."
  data-size="medium"
  data-locale="pt-BR"
  data-logo_alignment="center"
  data-width="280"
></div>
</div>

<footer style='font-family:"sans-serif"; font-size: 0.9rem; text-align: center'>
Autor: <a href="https://tarcisomesquita.github.io" target="_blank">Tarciso Mesquita</a><br/>
Esta obra está licenciada com uma Licença<br><a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.pt-br" target="_blank">Creative Commons Atribuição 4.0 Internacional</a>
<script src="https://tarcisomesquita.github.io/log.js" onload="logsend()" async defer></script>
</footer>
<br>
</body>
</html>
