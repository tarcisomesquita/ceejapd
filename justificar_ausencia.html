<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Justificativa de ausência</title>
<meta name="description" content="Justificar ausência no CEEJA Paulo Decourt">
<meta http-equiv="cache-control" content="max-age=0">
<meta viewport="width=device-width, initial-scale=1">
</head>

<body>
<p>Obrigado por justificar sua ausência no CEEJA Paulo Decourt.</p>

<p id="mensagem"></p>

<script>
let scriptId = 'AKfycbxHaQQt131DWaMoTPmsmDo9DPGqQKsQBoc1g009vbamVseWIJ0Oap62nwYygkMT9Ey8'; // 6 disciplinas =
// let scriptId = 'AKfycbySvCzNgMJ-nGiuvlRV9-9RxpqTdiJXT5GO2eA2wAUeAs7O7rrRSYBwEy7VJMqBipOx'; // 5 g_matricula
// let scriptId = 'AKfycbylHOlf0Sd2NF2QyBmqxRTsUrZJFZOdwMVWyFr-NLNEEJea2kPrfOxrXxFuvPoPyoKz'; // 4 apaga autorização
// let scriptId = 'AKfycbyksM9AGBxTdGxHiLUp3n8BQL6BVeMPJrce6b_-YRGts6V-G1dx0VWLjZVhk_zJCo7e';  // 3 innerHTML
// let scriptId = 'AKfycbwy1AOwz-wVOxJ-ErODAm8Yuu4Lm0xisNuhNJFkipFI0RgJ3ciUMKp2Cw0QhMWu-i-e' // 2 setValues
// let scriptId = 'AKfycbz63nZ-0xhXCoTE2C6TsEZhkmMmFycXSEyj-pxZSb_69q7UGZo0jGer7uOvCi4mPRFN' // 1 primeira

let parametros = new URLSearchParams(window.location.search);
let a;
let r;

if (parametros.has('a')) a = parametros.get('a');
else a = '';

if (parametros.has('r')) r = parametros.get('r');
else r = '';

let s = document.createElement('script');
s.src = `https://script.google.com/macros/s/${scriptId}/exec?a=${a}&r=${r}`;
document.head.appendChild(s);
</script>
<script>
function getCookie(cname) {
  let name = cname + "=";
  let ca = document.cookie.split(';');
  for(let i = 0; i < ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') c = c.substring(1);
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return '';
}

let token = getCookie('token');
let email = getCookie('email');

const set_cookie = (id,value) => {
  let expira = new Date((new Date()).getTime() + 365*24*3600*1000).toISOString();
  document.cookie = `${id}=${value};expires=${expira};path=${location.pathname};`;
}

if (token === '') {
  token = (Math.random().toString(36)+"00000000000").substring(2,13).toUpperCase();
  set_cookie('token',token);
}

if (email === '') {
  email = 'indefinido@gmail.com';
  set_cookie('email',email);
}

let log = `entry.340072360=${location.href};${token};${email};${screen.width}x${screen.height};${navigator.deviceMemory};${navigator.userAgent.replace(/;/g,',')}`;

fetch(
  'https://docs.google.com/forms/u/0/d/e/1FAIpQLScGwq8tvtiFUjhTQ58SlhN0b9rymqGGeXbJJoFB2YWks4FSPA/formResponse', 
  {
    method: 'POST',
    mode: 'no-cors',
    credentials: 'omit',
    headers: {  
      'Content-type': 'application/x-www-form-urlencoded;charset=utf-8'
    },
    'body': encodeURI(log)
  }
);
</script>

</body>
</html>
