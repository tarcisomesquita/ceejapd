<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta viewport='width=device-width'>

<title>CEEJA Paulo Decourt</title>

<script src="https://apis.google.com/js/api:client.js"></script>
<script>
//https://developers.google.com/identity/sign-in/web/sign-in
//https://console.cloud.google.com/apis/credentials

//https://myaccount.google.com/permissions
//https://codebeautify.org/jsviewer
var token = ''
var usuario = ''; 
var googleUser = {};

function startApp() {
  gapi.load(
    'auth2',
    function() {
      auth2 = gapi.auth2.init({client_id: '330234016508-6d6d97vqrtofusi7f85c9t1iu6nmtced.apps.googleusercontent.com'});
      auth2.attachClickHandler(
        document.getElementById('customBtn'), 
        {},
        function(googleUser) {
          token = googleUser.getAuthResponse().id_token;
          usuario = googleUser.getBasicProfile().getEmail();
          document.getElementById('mail').innerText = "Usuário: " + usuario;
          document.getElementById('customBtn').style.visibility = 'hidden';
        }, 
        function(error) {
          usuario = JSON.stringify(error, undefined, 2);
        }
      );
    }
  );
}

function anote() {
  let info = "ceejapd/index.html" + 
             "\nusuario: " + usuario + 
             "\nuserAgent: " + navigator.userAgent + 
             "\nscreen.width: " + screen.width + 
             "\nscreen.height: " + screen.height + 
             "\ninnerWidth: " + innerWidth + 
             "\ninnerHeight: " + innerHeight + 
             "\ndeviceMemory: " + navigator.deviceMemory + "GiB of RAM";

  fetch(
    "https://docs.google.com/forms/u/0/d/e/1FAIpQLSeH6hDfEOI6jvgDsdkuuUeah_FU3dPGxZZr-sBBkIjj4Hkwog/formResponse",
    {
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded"
      },
      body: 'entry.667481942=' + escape(info),
    }
  );
}
</script>


<script>
// HTTP GET and POST have limit of 2048 characters.

function avaliacao(){
  window.open('https://ceejapd.blogspot.com/p/avaliacaov5.html?matricula=' + document.getElementById('matricula').value + '&token=' + token);
}

function gerar_passaporte(){
  window.open('https://script.google.com/macros/s/AKfycbzeRnfDQB8NpLu1YXN84uRr_HyBFYIZvwYUtre1TmmGfMxs9Il_BdET/exec?matricula=' + document.getElementById('matricula').value + '&token=' + token);
}

function mkboletim(){
  window.open('https://script.google.com/macros/s/AKfycbzTyOey45kUt0KB8PHPrrfqxusv_u2ioOUTOd03w1hoC2WDJXGjgIo/exec?matricula=' + document.getElementById('matricula').value + '&token=' + token);
}

function requerimento_matricula(){
  window.open('https://script.google.com/macros/s/AKfycbzrQWhUGKvd9nmujuxkMiih4xB85pllTm2cMoy6PDk_o9xypvDoQ04I/exec?matricula=' + document.getElementById('matricula').value + '&token=' + token);
}

function relatorio_anual(){
  window.open('https://script.google.com/macros/s/AKfycby4qN4l4bCo8FZn_xD2G8uCWqjSlPXQTynIc8HIN-MsUrDG1NUNRJLnrw/exec?token=' + token);
}

function permissoes(){
  window.open('https://script.google.com/macros/s/AKfycbw5KAnRugIwei2GCKWWQr6wBk8-C4tBd26zp4mp9FI/dev?token=' + token);
}

function ps(){
  window.open('https://ceejapd.blogspot.com/p/ps.html?matricula=' + document.getElementById('matricula').value + '&token=' + token);
}

function passaporte(){
  document.getElementById('page').innerHTML = 'Aguarde 1 minuto. Gerando arquivo...';
  document.getElementById('page').style.cursor = 'wait';
  
  if (token === '') {
    window.alert("Precisa fazer login.");
  }
  else {
    let matricula = prompt("Digite o número da matrícula",);
    
    window.top.location.href = 'https://tarcisomesquita.github.io/ceejapd/page.html?id=' + 
      AKfycbzu4q8qKPPsXL9l5NqR9j281E9UC6WFvX0hGZrX44C2oRNUaazSOAGPvZKRYXg4_ili3w' + &matricula=' + matricula + '&token=' + token;
  }
}
</script>

<style>
body {
  line-height: 23px;
  font-size: 16px;
  font-family: 'Open Sans',sans-serif;
}
a:link    {color:#2160DE; text-decoration:none;}      /* unvisited link  */
a:visited {color:#2160DE; text-decoration:none;}      /* visited link    */
a:hover   {color:#2160DE; text-decoration:underline;} /* mouse over link */
a:active  {color:#2160DE; text-decoration:underline;} /* selected link   */

#customBtn {
  display: inline-block;
  background: #1a73e8;
  color: #ffffff;
  border: 1px solid transparent;
  font-size: 14px;
  line-height: 16px;
  margin-left: 10px;
  margin-right: 8px;
  min-width: 96px;
  padding: 9px 23px;
  text-align: center;
  vertical-align: middle;
  -moz-border-radius: 4px;
  border-radius: 4px;
  box-sizing: border-box;
}

#customBtn:hover {
  cursor: pointer;
}
</style>

</head>

<body onload='startApp()'>

<div id="page">

<div id="customBtn" class="customBtn">Fazer login</div>
<div id="mail"></div>

<p>Matrícula <input type="text" minlength="6" maxlength="6" id="matricula" name="matricula_n"></p>
<br />
<a href="https://bit.ly/ceejaonline">Drive Livros</a><br />
<br />
<a href="" onclick="avaliacao()">Pegar avaliação</a><br />
<br />
<a href="" onclick="passaporte()" style="color:#22BB22">Ver notas (passaporte)</a><br />
<a href="" onclick="gerar_passaporte()">Passaporte (versão antiga)</a><br />
<br />
<a href="https://bit.ly/escolapaulo">Formulário de rematrícula</a><br />
<br />
<br />
<br />
<a href="https://bit.ly/PD_POR">Português</a><br />
<a href="https://bit.ly/PD_ING">Ingles</a><br />
<a href="https://bit.ly/PD_ART">Arte</a><br />
<a href="https://bit.ly/PD_MAT">Matemática</a><br />
<a href="https://bit.ly/PD_HIS">História</a><br />
<a href="https://bit.ly/PD_GEO">Geografia</a><br />
<a href="https://bit.ly/PD_FIL">Filosofia</a><br />
<a href="https://bit.ly/PD_SOC">Sociologia</a><br />
<a href="https://bit.ly/PD_BIO">Biologia</a><br />
<a href="https://bit.ly/PD_QUI">Química</a><br />
<a href="https://bit.ly/PD_FIS">Física</a><br />
<br />
<a href="" onclick="mkboletim()">Gerar boletim</a><br />
<br />
<br />
<br />
<a href="https://drive.google.com/drive/folders/18TxnjlmMWt7-ifq5xqS5ZYed9iPCggs7">Drive Secretaria</a><br />
<br />
<a href="" onclick="requerimento_matricula()">Requerimento de matrícula</a><br />
<br />
<a href="" onclick="relatorio_anual()">Relatório anual</a><br />
<!--<br />
<a href="" onclick="permissoes()">Atualizar permissões</a><br />-->
<br />
<br />
<br />
<a href="https://facebook.com/ceejapaulodecourt">facebook</a><br />
<br />
<a href="https://instagram.com/ceeja.paulo.decourt">instagram</a><br />
<br />
<a href="https://www.youtube.com/channel/UCaugpxhjj2F7aOfbG4k3TFQ/videos">youtube</a><br />
<br />
<br />
<br />
<br />
<br />
</div><!-- page -->

</body>
</html>
