<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta viewport='width=device-width'>

<title>CEEJA Paulo Decourt</title>

<script src="https://apis.google.com/js/api:client.js"></script>
<script>
var auth2;
var googleUser;
var token_update;
var token = '';
var usuario = '';
var matricula = '';
var avaliacao_p = '';
var dia_i = '';
var dia_f = '';
var whatsapp_antigo = '';
var whatsapp_novo = '';
var email_antigo = '';
var email_novo = '';
var avaliacao_quimica = 'AKfycby482wf01AUOmY6FDt6cAE-KUAF-plIMyND_A1wAm8GQHnSPbsD_FSb00SUrvNJau6h4w'; // v 5
var avaliacao_sociologia = 'AKfycbwzvENsMD9XDQ-adfYWZPW2oTzH8qt5-FpJDMZE73A_YjUnl17PGWyMbXr41S0HpD9r'; // v 5
var avaliacao_geografia = 'AKfycbyMDEJ04KGXm2wq8hOVmm7esBquuBpSsn_4aw1hd3g_-Pi2MY6YtD8SztPJRuNDo3zS'; // v 5
var avaliacao_filosofia = 'AKfycbyrwJf5jKTlgv5c2aqQ_pg2f1tKcqajqXjO1Bl01PQHYreYc42ZhhzQE_HRskKSw4-P7w'; // v 11
var avaliacao_v = 'AKfycbxcOij4yGGldzC1avEX27AihvRLEultPYrgLJvkzTPAcrb4BMREGsbQKjkolThM7AhJ'; // v 43
var passaporte_v = 'AKfycbyIwHeoXzeizDbXqKuF9cTM4yp8v4PiiyQmKbkMKJDHS1QrXs0cuVZWHwf-M9lEiRkG'; // v 16
var atendimento_v = 'AKfycbxVBUkORXNY4uw8GnPuK46yKX68usQDFjQlhsu1ZLokfBzLNmvBTgfmrKfz6hkvJT8mcA'; // v 2
var boletim_v = 'AKfycbzPy61o1jOHKN4VKncONVJTQ-62T4AJXUx--wLdssC_E_ID6bBxPONLlhCiDOwQgwKv'; // v 25
var whatsapp_v = 'AKfycbypEHDq5skbHOlSsXqUuDkM152E1p0d9WWNtXW53LEqz3wbmJ722wGG0BHVqzPc1TZK'; // v 5
var email_v = 'AKfycbzHRXK5DOQ5JLxGvYFkoK8x2qWaSe4JtUpOQm4fmGISMaPPosznywPRvwMXxSECrdlBaA'; // v 2
var requerimento_v = 'AKfycbxiA6k8-d1B_U1YRyU1mb9tZeXmRSU4s9kg8wy8MckURRIH1nXFI3fPWw--c6cJmX9A'; // v 4
var boletim_file_v = 'AKfycbzHJ8d72DbcrNNkrknjfzXjmRlKYFfI_LyNLBz4KRcLUlj7wNANsQxsMjg8vPANGmSMjw'; // v 7
var historico_v = 'AKfycbwGhUQ6D3scPw7PHgynssHZ8yUohgjys_kaCwCODB-G8cqKP5SSKc41BgcEiCkyrVxW'; // v 2
var relatorio_v = 'AKfycbztJ0ILQ3eIzzioK-iG7ycG8kIQomntiJ2SPuTsnoDgB2TV9IKy3jMgN-AwXb0OgSxf'; // v 4

var startApp = function() {
  gapi.load('auth2', initSignIn);
};

var initSignIn = function() {
  auth2 = gapi.auth2.init({client_id: '330234016508-6d6d97vqrtofusi7f85c9t1iu6nmtced.apps.googleusercontent.com', scope:'profile email'});
  
  auth2.attachClickHandler(document.getElementById('customBtn'), {}, null, null);
  
  auth2.isSignedIn.listen(signinChanged);

  if (auth2.isSignedIn.get() == true) {
    auth2.signIn(); // |  signOut()
  }
  
  googleUser = auth2.currentUser.get();
};

function sair() {
  window.location.href = "https://accounts.google.com/Logout";
//  auth2.signOut()
};

function informe(mensagem) {
  document.getElementById("texto").value = mensagem;
  document.forms.formlog2.submit();
}

var signinChanged = function (val) {
  if (val) {
    //console.log('signin true');
    token = googleUser.getAuthResponse().id_token;
    usuario = googleUser.getBasicProfile().getEmail();             // | getImageUrl() | getName()
    //informe('LogIn: ' + usuario);
    document.getElementById('mail').innerText = usuario;
    document.getElementById('customBtn').style.display = 'none';
    document.getElementById('bmail').style.display = 'block';
    //console.log('usuario: ' + usuario);
    //console.log('token_id: ' + token);
    token_update = window.setTimeout(timmer, (googleUser.getAuthResponse().expires_in - 1200) * 1000);
  }
  else {
    //console.log('signin false');
    token = '';
    usuario = '';
    document.getElementById('customBtn').style.display = 'inline';
    document.getElementById('bmail').style.display = 'none';
    window.clearTimeout(token_update);
  }
};

var timmer = function() {
  googleUser.reloadAuthResponse();
  token = googleUser.getAuthResponse().id_token;
  //console.log('token_id: ' + token);
  token_update = window.setTimeout(timmer, (googleUser.getAuthResponse().expires_in - 1200) * 1000);
}

function avaliacao_fis(){
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('container').style.display = 'inline';
    document.getElementById('avaliacao_id').style.display = 'inline';
    document.getElementById('avaliacao_matricula_id').focus();

    document.getElementById('avaliacao_matricula_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{6}/.test(avaliacao_matricula_id.value)){document.getElementById("avaliacao_avaliacao_id").focus()}'
    );
    
    document.getElementById('avaliacao_avaliacao_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13){document.getElementById("avaliacao_button_id").focus()}'
    );

    document.getElementById('avaliacao_button_id').setAttribute(
      'onclick',
      'if (/[0-9]{6}/.test(avaliacao_matricula_id.value)){matricula = document.getElementById("avaliacao_matricula_id").value; avaliacao_p = document.getElementById("avaliacao_avaliacao_id").value; avaliacao_fis_b()}'
    );
  }
}

function avaliacao_fis_b() {
  document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
  document.getElementById('page').style.cursor = 'wait';
  
  let s = document.createElement('script');
  s.src = 'https://script.google.com/macros/s/' + avaliacao_v + '/exec?matricula=' + matricula + '&avaliacao=' + avaliacao_p + '&token=' + token;
  s.onerror = function () {
    document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
    informe('ERRO: ceejapd: load avaliacao');
  };
  document.body.appendChild(s);
}

function avaliacao_fil() {
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('container').style.display = 'inline';
    document.getElementById('avaliacao_id').style.display = 'inline';
    document.getElementById('avaliacao_matricula_id').focus();

    document.getElementById('avaliacao_matricula_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{6}/.test(avaliacao_matricula_id.value)){document.getElementById("avaliacao_avaliacao_id").focus()}'
    );
    
    document.getElementById('avaliacao_avaliacao_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13){document.getElementById("avaliacao_button_id").focus()}'
    );

    document.getElementById('avaliacao_button_id').setAttribute(
      'onclick',
      'if (/[0-9]{6}/.test(avaliacao_matricula_id.value)){matricula = document.getElementById("avaliacao_matricula_id").value; avaliacao_p = document.getElementById("avaliacao_avaliacao_id").value; avaliacao_fil_b()}'
    );
  }
}

function avaliacao_fil_b() {
  document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
  document.getElementById('page').style.cursor = 'wait';
  
  let s = document.createElement('script');
  s.src = 'https://script.google.com/macros/s/' + avaliacao_filosofia + '/exec?matricula=' + matricula + '&avaliacao=' + avaliacao_p + '&token=' + token;
  s.onerror = function () {
    document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
    informe('ERRO: ceejapd: load avaliacao');
  };
  document.body.appendChild(s);
}

function avaliacao_geo() {
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('container').style.display = 'inline';
    document.getElementById('avaliacao_a_id').style.display = 'inline';
    document.getElementById('avaliacao_a_matricula_id').focus();

    document.getElementById('avaliacao_a_matricula_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{6}/.test(avaliacao_a_matricula_id.value)){document.getElementById("avaliacao_a_avaliacao_id").focus()}'
    );
    
    document.getElementById('avaliacao_a_avaliacao_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13){document.getElementById("avaliacao_a_button_id").focus()}'
    );

    document.getElementById('avaliacao_a_button_id').setAttribute(
      'onclick',
      'if (/[0-9]{6}/.test(avaliacao_a_matricula_id.value)){matricula = document.getElementById("avaliacao_a_matricula_id").value; avaliacao_p = document.getElementById("avaliacao_a_avaliacao_id").value; avaliacao_geo_b()}'
    );
  }
}

function avaliacao_geo_b() {
  document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
  document.getElementById('page').style.cursor = 'wait';
  
  let s = document.createElement('script');
  s.src = 'https://script.google.com/macros/s/' + avaliacao_geografia + '/exec?matricula=' + matricula + '&avaliacao=' + avaliacao_p + '&token=' + token;
  s.onerror = function () {
    document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
    informe('ERRO: ceejapd: load avaliacao');
  };
  document.body.appendChild(s);
}

function avaliacao_soc() {
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
     document.getElementById('container').style.display = 'inline';
    document.getElementById('avaliacao_a_id').style.display = 'inline';
    document.getElementById('avaliacao_a_matricula_id').focus();

    document.getElementById('avaliacao_a_matricula_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{6}/.test(avaliacao_a_matricula_id.value)){document.getElementById("avaliacao_a_avaliacao_id").focus()}'
    );
    
    document.getElementById('avaliacao_a_avaliacao_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13){document.getElementById("avaliacao_a_button_id").focus()}'
    );

    document.getElementById('avaliacao_a_button_id').setAttribute(
      'onclick',
      'if (/[0-9]{6}/.test(avaliacao_a_matricula_id.value)){matricula = document.getElementById("avaliacao_a_matricula_id").value; avaliacao_p = document.getElementById("avaliacao_a_avaliacao_id").value; avaliacao_soc_b()}'
    );
  }
}

function avaliacao_soc_b() {
  document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
  document.getElementById('page').style.cursor = 'wait';
  
  let s = document.createElement('script');
  s.src = 'https://script.google.com/macros/s/' + avaliacao_sociologia + '/exec?matricula=' + matricula + '&avaliacao=' + avaliacao_p + '&token=' + token;
  s.onerror = function () {
    document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
    informe('ERRO: ceejapd: load avaliacao');
  };
  document.body.appendChild(s);
}

function avaliacao_qui() {
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('container').style.display = 'inline';
    document.getElementById('avaliacao_a_id').style.display = 'inline';
    document.getElementById('avaliacao_a_matricula_id').focus();

    document.getElementById('avaliacao_a_matricula_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{6}/.test(avaliacao_a_matricula_id.value)){document.getElementById("avaliacao_a_avaliacao_id").focus()}'
    );
    
    document.getElementById('avaliacao_a_avaliacao_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13){document.getElementById("avaliacao_a_button_id").focus()}'
    );

    document.getElementById('avaliacao_a_button_id').setAttribute(
      'onclick',
      'if (/[0-9]{6}/.test(avaliacao_a_matricula_id.value)){matricula = document.getElementById("avaliacao_a_matricula_id").value; avaliacao_p = document.getElementById("avaliacao_a_avaliacao_id").value; avaliacao_qui_b()}'
    );
  }
}

function avaliacao_qui_b() {
  document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
  document.getElementById('page').style.cursor = 'wait';
  
  let s = document.createElement('script');
  s.src = 'https://script.google.com/macros/s/' + avaliacao_quimica + '/exec?matricula=' + matricula + '&avaliacao=' + avaliacao_p + '&token=' + token;
  s.onerror = function () {
    document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
    informe('ERRO: ceejapd: load avaliacao');
  };
  document.body.appendChild(s);
}


function avaliacao(){
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
    document.getElementById('page').style.cursor = 'wait';
    
    let s = document.createElement('script');
    s.src = 'https://script.google.com/macros/s/' + avaliacao_v + '/exec?token=' + token;
    s.onerror = function () {
      document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
      informe('ERRO: ceejapd: load avaliacao');
    };
    document.body.appendChild(s);
  }
}

function passaporte(){
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('container').style.display = 'inline';
    document.getElementById('box').style.display = 'inline';
    document.getElementById('matricula_id').focus();
    
    document.getElementById('matricula_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{6}/.test(matricula_id.value)){document.getElementById("matricula_button").focus();}'
    );
      
    document.getElementById('matricula_button').setAttribute(
      'onclick',
      'if (/[0-9]{6}/.test(matricula_id.value)){matricula = document.getElementById("matricula_id").value; passaporte_b()}'
    );
  }
}

function passaporte_b() {
  document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
  document.getElementById('page').style.cursor = 'wait';
  
  let s = document.createElement('script');
  s.src = 'https://script.google.com/macros/s/' + passaporte_v + '/exec?matricula=' + matricula + '&token=' + token;
  s.onerror = function () {
    document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
    informe('ERRO: ceejapd: load passaporte');
  };
  document.body.appendChild(s);
}

function atendimento(){
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
    document.getElementById('page').style.cursor = 'wait';
    
    let s = document.createElement('script');
    s.src = 'https://script.google.com/macros/s/' + atendimento_v + '/exec?token=' + token;
    s.onerror = function () {
      document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
      informe('ERRO: ceejapd: load atendimento');
    };
    document.body.appendChild(s);
  }
}

function boletim(){
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('container').style.display = 'inline';
    document.getElementById('box').style.display = 'inline';
    document.getElementById('matricula_id').focus();
    
    document.getElementById('matricula_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{6}/.test(matricula_id.value)){document.getElementById("matricula_button").focus()}'
    );
      
    document.getElementById('matricula_button').setAttribute(
      'onclick',
      'if (/[0-9]{6}/.test(matricula_id.value)){matricula = document.getElementById("matricula_id").value; boletim_b()}'
    );
  }
}

function boletim_b() {
  document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
  document.getElementById('page').style.cursor = 'wait';
  
  let s = document.createElement('script');
  s.src = 'https://script.google.com/macros/s/' + boletim_v + '/exec?matricula=' + matricula + '&token=' + token;
  s.onerror = function () {
    document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
    informe('ERRO: ceejapd: load boletim');
  };
  document.body.appendChild(s);
  informe(navigator.userAgent);
}

function whatsapp(){
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('container').style.display = 'inline';
    document.getElementById('box').style.display = 'inline';
    document.getElementById('matricula_id').focus();
    
    document.getElementById('matricula_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{6}/.test(matricula_id.value)){document.getElementById("matricula_button").focus()}'
    );
      
    document.getElementById('matricula_button').setAttribute(
      'onclick',
      'if (/[0-9]{6}/.test(matricula_id.value)){matricula = document.getElementById("matricula_id").value; whatsapp_b()}'
    );
  }
}

function whatsapp_b() {
  document.getElementById('container').style.display = 'inline';
  document.getElementById('whatsapp_id').style.display = 'inline';
  document.getElementById('whatsapp_antigo_id').focus();
  
  document.getElementById('whatsapp_antigo_id').setAttribute(
    'onkeydown',
    'if (event.keyCode == 13 && /\\([0-9]{2}\\)[0-9]\\.[0-9]{4}-[0-9]{4}/.test(whatsapp_antigo_id.value)){document.getElementById("whatsapp_novo_id").focus();}'
  );
  
  document.getElementById('whatsapp_novo_id').setAttribute(
    'onkeydown',
    'if (event.keyCode == 13 && /\\([0-9]{2}\\)[0-9]\\.[0-9]{4}-[0-9]{4}/.test(whatsapp_novo_id.value)){document.getElementById("whatsapp_button").focus();}'
  );
   
  document.getElementById('whatsapp_button').setAttribute(
    'onclick',
    'if (/\\([0-9]{2}\\)[0-9]\\.[0-9]{4}-[0-9]{4}/.test(whatsapp_antigo_id.value) && /\\([0-9]{2}\\)[0-9]\\.[0-9]{4}-[0-9]{4}/.test(whatsapp_novo_id.value)){ whatsapp_antigo = escape(document.getElementById("whatsapp_antigo_id").value); whatsapp_novo = escape(document.getElementById("whatsapp_novo_id").value); whatsapp_c()}'
  );
}

function whatsapp_c() {
  document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Atualizando...</p>';
  document.getElementById('page').style.cursor = 'wait';
  
  let s = document.createElement('script');
  s.src = 'https://script.google.com/macros/s/' + whatsapp_v + '/exec?matricula=' + matricula + '&whatsapp_antigo=' + whatsapp_antigo + '&whatsapp_novo=' + whatsapp_novo + '&token=' + token;
  s.onerror = function () {
    document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
    informe('ERRO: ceejapd: load whatsapp');
  };
  document.body.appendChild(s);
}

function email(){
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('container').style.display = 'inline';
    document.getElementById('box').style.display = 'inline';
    document.getElementById('matricula_id').focus();
    
    document.getElementById('matricula_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{6}/.test(matricula_id.value)){document.getElementById("matricula_button").focus()}'
    );
      
    document.getElementById('matricula_button').setAttribute(
      'onclick',
      'if (/[0-9]{6}/.test(matricula_id.value)){matricula = document.getElementById("matricula_id").value; email_b()}'
    );
  }
}

function email_b() {
  document.getElementById('container').style.display = 'inline';
  document.getElementById('email_id').style.display = 'inline';
  document.getElementById('email_antigo_id').focus();
  
  document.getElementById('email_antigo_id').setAttribute(
    'onkeydown',
    'if (event.keyCode == 13){document.getElementById("email_novo_id").focus();}'
  );
  
  document.getElementById('email_novo_id').setAttribute(
    'onkeydown',
    'if (event.keyCode == 13){document.getElementById("email_button").focus();}'
  );
   
  document.getElementById('email_button').setAttribute(
    'onclick',
    'email_antigo = escape(document.getElementById("email_antigo_id").value); email_novo = escape(document.getElementById("email_novo_id").value); email_c();'
  );
}

function email_c() {
  document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Atualizando...</p>';
  document.getElementById('page').style.cursor = 'wait';
  
  let s = document.createElement('script');
  s.src = 'https://script.google.com/macros/s/' + email_v + '/exec?matricula=' + matricula + '&email_antigo=' + email_antigo + '&email_novo=' + email_novo + '&token=' + token;
  s.onerror = function () {
    document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
    informe('ERRO: ceejapd: load email');
  };
  document.body.appendChild(s);
}

function requerimento(){
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('container').style.display = 'inline';
    document.getElementById('box').style.display = 'inline';
    document.getElementById('matricula_id').focus();
    
    document.getElementById('matricula_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{6}/.test(matricula_id.value)){document.getElementById("matricula_button").focus()}'
    );
      
    document.getElementById('matricula_button').setAttribute(
      'onclick',
      'if (/[0-9]{6}/.test(matricula_id.value)){matricula = document.getElementById("matricula_id").value; requerimento_b()}'
    );
  }
}

function requerimento_b() {
  document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
  document.getElementById('page').style.cursor = 'wait';
  
  let s = document.createElement('script');
  s.src = 'https://script.google.com/macros/s/' + requerimento_v + '/exec?matricula=' + matricula + '&token=' + token;
  s.onerror = function () {
    document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
    informe('ERRO: ceejapd: load email');
  };
  document.body.appendChild(s);
}

function boletim_file(){
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('container').style.display = 'inline';
    document.getElementById('dia_id').style.display = 'inline';
    document.getElementById('dia_i_id').focus();
    
    document.getElementById('dia_i_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{2}\\/[0-9]{2}\\/[0-9]{4}/.test(dia_i_id.value)){document.getElementById("dia_f_id").focus();}'
    );

    document.getElementById('dia_f_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{2}\\/[0-9]{2}\\/[0-9]{4}/.test(dia_f_id.value)){document.getElementById("dia_button").focus();}'
    );
      
    document.getElementById('dia_button').setAttribute(
      'onclick',
      'if (/[0-9]{2}\\/[0-9]{2}\\/[0-9]{4}/.test(dia_i_id.value) && /[0-9]{2}\\/[0-9]{2}\\/[0-9]{4}/.test(dia_f_id.value)){dia_i = document.getElementById("dia_i_id").value.replace(/\\//g,""); dia_f = document.getElementById("dia_f_id").value.replace(/\\//g,""); boletim_file_b()}'
    );
  }
}

function boletim_file_b() {
  document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
  document.getElementById('page').style.cursor = 'wait';
  
  let s = document.createElement('script');
  s.src = 'https://script.google.com/macros/s/' + boletim_file_v + '/exec?dia_i=' + dia_i + '&dia_f=' + dia_f + '&token=' + token;
  s.onerror = function () {
    document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
    informe('ERRO: ceejapd: load boletim_file');
  };
  document.body.appendChild(s);
}

function historico(){
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('container').style.display = 'inline';
    document.getElementById('box').style.display = 'inline';
    document.getElementById('matricula_id').focus();
    
    document.getElementById('matricula_id').setAttribute(
      'onkeydown',
      'if (event.keyCode == 13 && /[0-9]{6}/.test(matricula_id.value)){document.getElementById("matricula_button").focus()}'
    );
      
    document.getElementById('matricula_button').setAttribute(
      'onclick',
      'if (/[0-9]{6}/.test(matricula_id.value)){matricula = document.getElementById("matricula_id").value; historico_b()}'
    );
  }
}

function historico_b() {
  document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
  document.getElementById('page').style.cursor = 'wait';
  
  let s = document.createElement('script');
  s.src = 'https://script.google.com/macros/s/' + historico_v + '/exec?matricula=' + matricula + '&token=' + token;
  s.onerror = function () {
    document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
    informe('ERRO: ceejapd: load historico');
  };
  document.body.appendChild(s);
}

function relatorio(){
  if (token === '') {
    aviso('ERRO: Precisa fazer login.');
  }
  else {
    document.getElementById('page').innerHTML = '<p class="erro">Aguarde 1 minuto. Gerando arquivo...</p>';
    document.getElementById('page').style.cursor = 'wait';
    
    let s = document.createElement('script');
    s.src = 'https://script.google.com/macros/s/' + relatorio_v + '/exec?token=' + token;
    s.onerror = function () {
      document.getElementById('page').innerHTML = '<p class="erro">ERRO ao carregar. Informe o professor.</p>';
      informe('ERRO: ceejapd: load relatorio');
    };
    document.body.appendChild(s);
  }
}

function aviso(mensagem) {
  document.getElementById('container').style.display = 'inline';
  document.getElementById('aviso').style.display = 'inline';
  document.getElementById('mensagem').innerText = mensagem;
  document.getElementById('aviso_button').focus();
}

function aviso_b() {
  document.getElementById('container').style.display = 'none';
  document.getElementById('aviso').style.display = 'none';
}
</script>

<style>
body {
  height: 100%;
  background-color: #FFFFFF;
  font-family: 'Open Sans',sans-serif;
  color: #000000;
  font-size: 16px;
  line-height: 23px;
  text-align: justify;
  margin: 0px;
  padding: 5mm;
}

h1 {
  text-align: center;
}

a:link    {color:#2160DE; text-decoration:none;}      /* unvisited link  */
a:visited {color:#2160DE; text-decoration:none;}      /* visited link    */
a:hover   {color:#2160DE; text-decoration:underline;} /* mouse over link */
a:active  {color:#2160DE; text-decoration:underline;} /* selected link   */

pre {
  color: #000000;
}

.erro {
  text-align: center;
  font-size: 14pt;
  line-height: 20pt;
  font-weight: bold;
  
  margin: 0px;
  padding-top: 2cm;
  padding-bottom: 2cm;
  width: 100vw;
  background-color: #FFFF77;
  position: fixed;
  top: 30px;
}

.link {
  cursor:pointer
}

.link:hover, .link:active {
  text-decoration:underline;
}

#customBtn {
  display: inline-block;
  background: #1a73e8;
  color: #ffffff;
  border: 1px solid transparent;
  font-size: 16px;
  line-height: 23px;
  margin-left: 10px;
  margin-right: 8px;
  min-width: 96px;
  padding: 9px 23px;
  text-align: center;
  vertical-align: middle;
  -moz-border-radius: 4px;
  border-radius: 4px;
  box-sizing: border-box;
}

#customBtn:hover {
  cursor: pointer;
}

.container {
  display: none;
  position: fixed;
  top: 0px;
  left: 0px;
  width: 100vw;
  height: 100vh;
  background: #6C7A89;
  opacity: 0.5;
}

.box {
  display: none;
  position: fixed;
  top: 5%;
  left: 30%;
  background: #bbeeff;
  opacity: 1;
  padding: 30px;
  border: 2px solid #AAAAAA;
  text-align: center;
}

table, td, th {
  border: 1px solid black;
}

table { 
  border-collapse: collapse;
}
</style>

</head>

<body onload='startApp()'>

<div id="page">

<br />

<div id="customBtn" class="customBtn">Fazer login</div>
<p id="bmail" style="display:none">Usuário: <span id="mail" style='color:#DD4433'></span>
  <span onclick="informe('Logout: ' + usuario); console.log('Logout'); sair();" style="background:#cccccc;border: 1px solid #000000; margin-left:10px; margin-right:8px; min-width:96px; padding: 9px 23px; text-align:center; vertical-align:middle; -moz-border-radius:4px; border-radius:4px; box-sizing: border-box; cursor:pointer;">Sair</span>
</p>

<br />

<p><a href="https://youtube.com/channel/UCxd2y8b5DYrjH4yTHOwzxKg/videos">Dicas no Youtube</a></p>

<p><a href="https://bit.ly/ceejaonline">Drive Livros</a></p>

<p onclick="avaliacao_geo()" class='link' style='color:#22BB22'>Pegar avaliação de Geografia</p>

<p onclick="avaliacao_soc()" class='link' style='color:#22BB22'>Pegar avaliação de Sociologia</p>

<p onclick="avaliacao_fil()" class='link' style='color:#22BB22'>Pegar avaliação de Filosofia</p>

<p onclick="avaliacao_qui()" class='link' style='color:#22BB22'>Pegar avaliação de Química</p>

<p onclick="avaliacao_fis()" class='link' style='color:#22BB22'>Pegar avaliação de Física</p>

<p onclick="passaporte()" class='link' style='color:#22BB22'>Ver notas (passaporte)</p>

<p><a href="https://bit.ly/escolapaulo">Formulário de matrícula</a></p>

<p><a href="https://www.google.com/maps/dir//-22.856400368690867,-47.04246102053969/">Rota para CEEJA Paulo Decourt</a></p>

<br />

<p onclick="atendimento()" class='link' style='color:#DD6611'>Registros de atendimento</p>

<p onclick="boletim()" class='link' style='color:#DD6611'>Gerar boletim</p>

<p onclick="whatsapp()" class='link' style='color:#DD6611'>Atualizar WhatsApp</p>

<p onclick="email()" class='link' style='color:#DD6611'>Atualizar email</p>

<br />

<p><a href="https://drive.google.com/drive/folders/18TxnjlmMWt7-ifq5xqS5ZYed9iPCggs7" style='color:#AA33AA'>Drive Secretaria</a></p>

<p onclick="requerimento()" class='link' style='color:#DD4433'>Requerimento de matrícula</a></p>

<p onclick="boletim_file()" class='link' style='color:#DD4433'>Boletins para imprimir</a></p>

<p onclick="relatorio()" class='link' style='color:#DD4433'>Relatório anual</a></p>

<p onclick="historico()" class='link' style='color:#DD4433'>Gerar histórico</a></p>

<!--<p onclick="permissoes()" class='link' style='color:#DD4433'>Atualizar permissões</a></p>-->

<br />

<p><a href="https://facebook.com/ceejapaulodecourt">facebook</a></p>

<p><a href="https://instagram.com/ceeja.paulo.decourt">instagram</a></p>

<p><a href="https://www.youtube.com/channel/UCaugpxhjj2F7aOfbG4k3TFQ/videos">youtube</a></p>

<br />

<p><a href='https://tarcisomesquita.github.io/ceejapd/CEEJAs.html'>Outros CEEJAs</a></p>

<p><a href='https://youtu.be/VV_uiMx9w9g'>Ver para entender nosso trabalho</a></p>

<br />

<div id='container' class='container'>
</div>
<div id='box' class='box'>
  <p>Digite o número da matrícula:</p>
  <input 
    id="matricula_id" 
    type="text" 
    pattern="[0-9]{6}" 
    maxlength="6" 
    style="margin:5px"
  >
  <input 
    id="matricula_button" 
    type="button" 
    value="ok" 
  >
</div>

<div id='avaliacao_id' class='box' style='text-align: left'>
  <p>matrícula:<input 
    id="avaliacao_matricula_id" 
    type="text" 
    pattern="[0-9]{6}" 
    maxlength="6" 
    style="margin:5px"
  ></p>
  <p>avaliação: <select id='avaliacao_avaliacao_id' style='margin:5px'>
    <option value='1A'>1A</option>
    <option value='1B'>1B</option>
    <option value='2A'>2A</option>
    <option value='2B'>2B</option>
    <option value='3A'>3A</option>
    <option value='3B'>3B</option>
  </select></p>
  <p>visualizar:<input 
    id="avaliacao_button_id" 
    type="button" 
    value="ok" 
    style='margin:5px'
  ></p>
  <p>Terá <span style='color:#ff0000; font-weight:bold'>2 horas</span> para fazer</p>
</div>


<div id='avaliacao_a_id' class='box' style='text-align: left'>
  <p>matrícula:<input 
    id="avaliacao_a_matricula_id" 
    type="text" 
    pattern="[0-9]{6}" 
    maxlength="6" 
    style="margin:5px"
  ></p>
  <p>avaliação: <select id='avaliacao_a_avaliacao_id' style='margin:5px'>
    <option value='1A'>1A</option>
    <option value='2A'>2A</option>
    <option value='3A'>3A</option>
  </select></p>
  <p>visualizar:<input 
    id="avaliacao_a_button_id" 
    type="button" 
    value="ok" 
    style='margin:5px'
  ></p>
  <p>Terá <span style='color:#ff0000; font-weight:bold'>2 horas</span> para fazer</p>
</div>

<div id='dia_id' class='box'>
  <p>Digite o intervalo de dias (dd/mm/aaaa)</p>
  <p>Início:<input 
    id="dia_i_id" 
    type="text" 
    pattern="[0-9]{2}/[0-9]{2}/[0-9]{4}" 
    maxlength="10" 
    style="margin:5px"
  ></p>
  <p>Final:<input 
    id="dia_f_id" 
    type="text" 
    pattern="[0-9]{2}/[0-9]{2}/[0-9]{4}" 
    maxlength="10" 
    style="margin:5px"
  ></p>
  <br />
  <input 
    id="dia_button" 
    type="button" 
    value="ok" 
  >
</div>
<div id='whatsapp_id' class='box'>
  <p>Digite o número de Whatsapp no formato (##)9.####-####</p>
  <p>Antigo:<input 
    id="whatsapp_antigo_id" 
    type="text" 
    pattern="\([0-9]{2}\)[0-9]\.[0-9]{4}-[0-9]{4}" 
    maxlength="15" 
    style="margin:5px"
  ></p>
  <p>Novo:<input 
    id="whatsapp_novo_id" 
    type="text" 
    pattern="\([0-9]{2}\)[0-9]\.[0-9]{4}-[0-9]{4}" 
    maxlength="15" 
    style="margin:5px"
  ></p>
  <br />
  <input 
    id="whatsapp_button" 
    type="button" 
    value="ok" 
  >
</div>
<div id='email_id' class='box'>
  <p>Digite o endereço de email</p>
  <p>antigo:<input 
    id="email_antigo_id" 
    type="text" 
    style="margin:5px"
  ></p>
  <p>novo:<input 
    id="email_novo_id" 
    type="text" 
    style="margin:5px"
  ></p>
  <br />
  <input 
    id="email_button" 
    type="button" 
    value="ok" 
  >
</div>
<div id='aviso' class='box'>
  <p id='mensagem'></p>
  <input id='aviso_button' type="button" value="ok" onclick="aviso_b()">
</div>

<footer style='font-family:"sans-serif"; font-size:10px;'>
Autor: <a href='https://tarcisomesquita.github.io/me/'>Tarciso Mesquita</a><br/>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.pt_BR"><img alt="Licença Creative Commons" style="border-width:0" src="https://tarcisomesquita.github.io/me/CC-BY.png" /></a><br />Esta obra está licenciada com uma Licença <a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.pt_BR">Creative Commons Atribuição 4.0 Internacional</a>
<footer>
</div><!-- page -->

<iframe id="hiddenFrame" name="hiddenFrame" style="display:none"></iframe>
<form id="formlog2" style='display:none' enctype="application/x-www-form-urlencoded" action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSeH6hDfEOI6jvgDsdkuuUeah_FU3dPGxZZr-sBBkIjj4Hkwog/formResponse" method="POST" target="hiddenFrame">
<input id="texto" name="entry.667481942" type="hidden">
</form>

</body>
</html>
